<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>minilua::Interpreter class | MiniLua Value tracing lua interpreter</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://sp-uulm.github.io/MiniLua/">MiniLua</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">Value tracing lua interpreter</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li>
              <a href="namespaces.html">Namespaces</a>
              <ol>
                <li><a href="namespaceminilua.html">minilua</a></li>
              </ol>
            </li>
            <li><a href="https://lythenas.github.io/tree-sitter-cpp-api/">Tree-Sitter</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="4">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="https://github.com/sp-uulm/MiniLua/">GitHub</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="namespaceminilua.html">minilua</a>::<wbr/></span>Interpreter <span class="m-thin">class</span>
        </h1>
        <p>An interpreter instance is used to parse and evaluate lua source code.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li><a href="#autotoc_md2">Example</a></li>
            <li>
              Reference
              <ul>
                <li><a href="#typeless-methods">Constructors, destructors, conversion operators</a></li>
                <li><a href="#pub-methods">Public functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
<p>You can create the interpreter with initial source code or empty source code and then update the source code by calling <a href="classminilua_1_1Interpreter.html#aabb20a73723822998fa93527b12b3ee1" class="m-doc">Interpreter::<wbr />parse</a> and run the current source code by calling <a href="classminilua_1_1Interpreter.html#a47d8b89428d14ff81089a03b5521af22" class="m-doc">Interpreter::<wbr />evaluate</a>.</p><p>You can also apply a source change that was generated by the interpreter while evaluating and get the updated source code.</p><section id="autotoc_md2"><h2><a href="#autotoc_md2">Example</a></h2><pre class="m-code"><span class="n">minilua</span><span class="o">::</span><span class="n">Interpreter</span> <span class="n">interpreter</span><span class="p">{</span><span class="n">initial_source_code</span><span class="p">};</span>
<span class="n">interpreter</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">new_source_code</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">res</span> <span class="o">=</span> <span class="n">interpreter</span><span class="p">.</span><span class="n">evaluate</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">source_change</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">interpreter</span><span class="p">.</span><span class="n">apply_source_change</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">source_change</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">interpreter</span><span class="p">.</span><span class="n">evaluate</span><span class="p">();</span></pre></section>
        <section id="typeless-methods">
          <h2><a href="#typeless-methods">Constructors, destructors, conversion operators</a></h2>
          <dl class="m-doc">
            <dt id="a92b19c2ab392ab6dd649a498f21bdc98">
              <span class="m-doc-wrap-bumper"><a href="#a92b19c2ab392ab6dd649a498f21bdc98" class="m-doc-self">Interpreter</a>(</span><span class="m-doc-wrap">)</span>
            </dt>
            <dd>Initializes the interpreter with empty source code.</dd>
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#a83531f419cab1bae4a47de8c0a573775" class="m-doc">Interpreter</a>(</span><span class="m-doc-wrap">std::string initial_source_code)</span>
            </dt>
            <dd>Initializes the interpreter with the given source code.</dd>
          </dl>
        </section>
        <section id="pub-methods">
          <h2><a href="#pub-methods">Public functions</a></h2>
          <dl class="m-doc">
            <dt id="ae78f7ea9b48cf8dcef52fcd52909bb9e">
              <span class="m-doc-wrap-bumper">auto <a href="#ae78f7ea9b48cf8dcef52fcd52909bb9e" class="m-doc-self">config</a>(</span><span class="m-doc-wrap">) -&gt; InterpreterConfig &amp; -&gt; auto</span>
            </dt>
            <dd>Returns the current configuration.</dd>
            <dt id="a823f85eb6808ebb8ab00b844d2966033">
              <span class="m-doc-wrap-bumper">auto <a href="#a823f85eb6808ebb8ab00b844d2966033" class="m-doc-self">config</a>(</span><span class="m-doc-wrap">) const -&gt; const InterpreterConfig &amp; -&gt; auto</span>
            </dt>
            <dd>Returns the current configuration.</dd>
            <dt id="a152d730ec3216e3b7631834947518381">
              <span class="m-doc-wrap-bumper">void <a href="#a152d730ec3216e3b7631834947518381" class="m-doc-self">set_config</a>(</span><span class="m-doc-wrap"><a href="structminilua_1_1InterpreterConfig.html" class="m-doc">InterpreterConfig</a>)</span>
            </dt>
            <dd>Sets the configuration.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a21d22cbf0a310f0d2ab078be091ef0dc" class="m-doc">environment</a>(</span><span class="m-doc-wrap">) const -&gt; Environment &amp; -&gt; auto</span>
            </dt>
            <dd>Returns the environment for modification.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a70a6f29b22ed6b287bdbae3daaacf02e" class="m-doc">source_code</a>(</span><span class="m-doc-wrap">) const -&gt; const std::string &amp; -&gt; auto</span>
            </dt>
            <dd>Returns a view into the current source code.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#aabb20a73723822998fa93527b12b3ee1" class="m-doc">parse</a>(</span><span class="m-doc-wrap">std::string source_code) -&gt; ParseResult -&gt; auto</span>
            </dt>
            <dd>Parse fresh source code.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#af591dfaecfcd8acf6ba1373b6a2f991e" class="m-doc">apply_source_changes</a>(</span><span class="m-doc-wrap">std::vector&lt;<a href="structminilua_1_1SourceChange.html" class="m-doc">SourceChange</a>&gt;) -&gt; RangeMap -&gt; auto</span>
            </dt>
            <dd>Applies a list of single source changes.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a47d8b89428d14ff81089a03b5521af22" class="m-doc">evaluate</a>(</span><span class="m-doc-wrap">) -&gt; EvalResult -&gt; auto</span>
            </dt>
            <dd>Run the parsed program.</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="a83531f419cab1bae4a47de8c0a573775"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> minilua::<wbr />Interpreter::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a83531f419cab1bae4a47de8c0a573775" class="m-doc-self">Interpreter</a>(</span><span class="m-doc-wrap">std::string initial_source_code)</span></span>
            </h3>
            <p>Initializes the interpreter with the given source code.</p>
<p>Throws an exception if there was an error parsing the source code.</p>
          </div></section>
          <section class="m-doc-details" id="a21d22cbf0a310f0d2ab078be091ef0dc"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />Interpreter::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a21d22cbf0a310f0d2ab078be091ef0dc" class="m-doc-self">environment</a>(</span><span class="m-doc-wrap">) const -&gt; Environment &amp;</span></span>
            </h3>
            <p>Returns the environment for modification.</p>
<aside class="m-note m-info"><h4>Note</h4><p>This will not directly be used by the interpreter so you can just reuse an existing interpreter/environment without resetting it.</p></aside>
          </div></section>
          <section class="m-doc-details" id="a70a6f29b22ed6b287bdbae3daaacf02e"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />Interpreter::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a70a6f29b22ed6b287bdbae3daaacf02e" class="m-doc-self">source_code</a>(</span><span class="m-doc-wrap">) const -&gt; const std::string &amp;</span></span>
            </h3>
            <p>Returns a view into the current source code.</p>
<aside class="m-note m-danger"><h4>Warning</h4><p>The returned value will become invalid if the source code is changed (by calling parse or apply_source_changes).</p></aside>
          </div></section>
          <section class="m-doc-details" id="aabb20a73723822998fa93527b12b3ee1"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />Interpreter::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#aabb20a73723822998fa93527b12b3ee1" class="m-doc-self">parse</a>(</span><span class="m-doc-wrap">std::string source_code) -&gt; ParseResult</span></span>
            </h3>
            <p>Parse fresh source code.</p>
<p>Errors are part of <a href="structminilua_1_1ParseResult.html" class="m-doc">ParseResult</a>.</p>
          </div></section>
          <section class="m-doc-details" id="af591dfaecfcd8acf6ba1373b6a2f991e"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />Interpreter::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#af591dfaecfcd8acf6ba1373b6a2f991e" class="m-doc-self">apply_source_changes</a>(</span><span class="m-doc-wrap">std::vector&lt;<a href="structminilua_1_1SourceChange.html" class="m-doc">SourceChange</a>&gt;) -&gt; RangeMap</span></span>
            </h3>
            <p>Applies a list of single source changes.</p>
<p>This returns a map of ranges that were changed. Keys are the old ranges and values are the new ranges. Note that this map only contains ranges for the applied source changes. Other range might have moved and are not present in the map.</p>
          </div></section>
          <section class="m-doc-details" id="a47d8b89428d14ff81089a03b5521af22"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />Interpreter::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a47d8b89428d14ff81089a03b5521af22" class="m-doc-self">evaluate</a>(</span><span class="m-doc-wrap">) -&gt; EvalResult</span></span>
            </h3>
            <p>Run the parsed program.</p>
<p>Throws an exception when there is an error in the program. E.g. when you try to add incompatible values in lua.</p><p>Currently this throws <code>std::runtime_error</code>.</p>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>MiniLua Value tracing lua interpreter. Created with <a href="https://doxygen.org/">Doxygen</a> 1.8.17 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
