<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>minilua::CallContext class | MiniLua Value tracing lua interpreter</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://sp-uulm.github.io/MiniLua/">MiniLua</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">Value tracing lua interpreter</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li>
              <a href="namespaces.html">Namespaces</a>
              <ol>
                <li><a href="namespaceminilua.html">minilua</a></li>
              </ol>
            </li>
            <li><a href="https://lythenas.github.io/tree-sitter-cpp-api/">Tree-Sitter</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="4">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="https://github.com/sp-uulm/MiniLua/">GitHub</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="namespaceminilua.html">minilua</a>::<wbr/></span>CallContext <span class="m-thin">class</span>
        </h1>
        <p>Argument for lua <code><a href="classminilua_1_1Function.html" class="m-doc">Function</a></code>s.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#typeless-methods">Constructors, destructors, conversion operators</a></li>
                <li><a href="#pub-methods">Public functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
<p>Contains information for use in the implementation of native (and lua) functions.</p><p>Contains the arguments and the environment.</p><aside class="m-note m-danger"><h4>Warning</h4><p>The <code><a href="classminilua_1_1CallContext.html" class="m-doc">CallContext</a></code> and the <code><a href="classminilua_1_1Environment.html" class="m-doc">Environment</a></code> should not be copied and stored somewhere that outlives the function call. Because the environment may be freed after the call to the function ends. You can however safely store any <code><a href="classminilua_1_1Value.html" class="m-doc">Value</a></code>s or a copy of the arguments.</p></aside>
        <section id="typeless-methods">
          <h2><a href="#typeless-methods">Constructors, destructors, conversion operators</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#a780e56056d700663f495909afe2e3aa2" class="m-doc">CallContext</a>(</span><span class="m-doc-wrap"><a href="classminilua_1_1Environment.html" class="m-doc">Environment</a>* env)</span>
            </dt>
            <dd>Create a <a href="classminilua_1_1CallContext.html" class="m-doc">CallContext</a> from the <a href="classminilua_1_1Environment.html" class="m-doc">Environment</a>.</dd>
            <dt id="ad84f805e7584cc1be0e6273adc67f131">
              <span class="m-doc-wrap-bumper"><a href="#ad84f805e7584cc1be0e6273adc67f131" class="m-doc-self">CallContext</a>(</span><span class="m-doc-wrap">const <a href="classminilua_1_1CallContext.html" class="m-doc">CallContext</a>&amp;)</span>
            </dt>
            <dd>Copy constructor.</dd>
            <dt id="af3f5ddffca7ca2de436ecbb2e138bb82">
              <span class="m-doc-wrap-bumper"><a href="#af3f5ddffca7ca2de436ecbb2e138bb82" class="m-doc-self">CallContext</a>(</span><span class="m-doc-wrap"><a href="classminilua_1_1CallContext.html" class="m-doc">CallContext</a>&amp;&amp;)</span>
            </dt>
            <dd>Move constructor.</dd>
          </dl>
        </section>
        <section id="pub-methods">
          <h2><a href="#pub-methods">Public functions</a></h2>
          <dl class="m-doc">
            <dt id="af2863ce0add27da94c5fa2503f7fcf6a">
              <span class="m-doc-wrap-bumper">auto <a href="#af2863ce0add27da94c5fa2503f7fcf6a" class="m-doc-self">operator=</a>(</span><span class="m-doc-wrap">const <a href="classminilua_1_1CallContext.html" class="m-doc">CallContext</a>&amp;) -&gt; CallContext &amp; -&gt; auto</span>
            </dt>
            <dd>Copy assignment operator.</dd>
            <dt id="a974ff57abf037cbd3fb23a955f3ab9c2">
              <span class="m-doc-wrap-bumper">auto <a href="#a974ff57abf037cbd3fb23a955f3ab9c2" class="m-doc-self">operator=</a>(</span><span class="m-doc-wrap"><a href="classminilua_1_1CallContext.html" class="m-doc">CallContext</a>&amp;&amp;) -&gt; CallContext &amp; -&gt; auto</span>
            </dt>
            <dd>Move assignment operator.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#aefa84bac078774d83b37c386428e9295" class="m-doc">make_new</a>(</span><span class="m-doc-wrap"><a href="classminilua_1_1Vallist.html" class="m-doc">Vallist</a>,
              std::optional&lt;<a href="structminilua_1_1Range.html" class="m-doc">Range</a>&gt; location = std::nullopt) const -&gt; CallContext -&gt; auto</span>
            </dt>
            <dd>Create a new call context with new arguments.</dd>
            <dt>
              <div class="m-doc-template">template&lt;typename... Args&gt;</div>
              <span class="m-doc-wrap-bumper">auto <a href="#a0467e04c54ba89888313abf53fd1cea5" class="m-doc">make_new</a>(</span><span class="m-doc-wrap">Args... args,
              std::optional&lt;<a href="structminilua_1_1Range.html" class="m-doc">Range</a>&gt; location = std::nullopt) const -&gt; CallContext -&gt; auto</span>
            </dt>
            <dd>Create a new call context with new arguments.</dd>
            <dt id="acad4ec99ecb15f4bf96b7fc4d8a33fbd">
              <span class="m-doc-wrap-bumper">auto <a href="#acad4ec99ecb15f4bf96b7fc4d8a33fbd" class="m-doc-self">make_table</a>(</span><span class="m-doc-wrap">) const -&gt; Table -&gt; auto</span>
            </dt>
            <dd>Create a new table with the same allocator as the environment.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#aee2e19ab5f3c347575a2c32d8613e21c" class="m-doc">call_location</a>(</span><span class="m-doc-wrap">) const -&gt; std::optional&lt; Range &gt; -&gt; auto</span>
            </dt>
            <dd>The location of the call.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#aa294dae148654b06c23c24c6cce317c8" class="m-doc">environment</a>(</span><span class="m-doc-wrap">) const -&gt; Environment &amp; -&gt; auto</span>
            </dt>
            <dd>Returns a reference to the environment.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#ab9537a0dc7692d70a9a0fd169feed1a1" class="m-doc">get</a>(</span><span class="m-doc-wrap">const std::string&amp; name) const -&gt; Value -&gt; auto</span>
            </dt>
            <dd>Returns the value of a variable accessible from the function.</dd>
            <dt id="ae859857aa447fce6850f9700ed909692">
              <span class="m-doc-wrap-bumper">auto <a href="#ae859857aa447fce6850f9700ed909692" class="m-doc-self">arguments</a>(</span><span class="m-doc-wrap">) const -&gt; const Vallist &amp; -&gt; auto</span>
            </dt>
            <dd>Returns the arguments given to this function.</dd>
            <dt>
              <div class="m-doc-template">template&lt;typename... Ts&gt;</div>
              <span class="m-doc-wrap-bumper">auto <a href="#a471e7bb088bc46470edc30ac008e73f1" class="m-doc">expect_argument</a>(</span><span class="m-doc-wrap">size_t index) const -&gt; const Value &amp; -&gt; auto</span>
            </dt>
            <dd>Helper to check required arguments.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a64de6fc9188934f54712f286ccb7c13d" class="m-doc">unary_numeric_arg_helper</a>(</span><span class="m-doc-wrap">) const -&gt; std::tuple&lt; Number, UnaryOrigin &gt; -&gt; auto</span>
            </dt>
            <dd>Convenience method for writing unary numeric functions.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a21e7b7faef395d4762dda2f7ef8e6ac4" class="m-doc">binary_numeric_args_helper</a>(</span><span class="m-doc-wrap">) const -&gt; std::tuple&lt; Number, Number, BinaryOrigin &gt; -&gt; auto</span>
            </dt>
            <dd>Convenience method for writing unary numeric functions.</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="a780e56056d700663f495909afe2e3aa2"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> minilua::<wbr />CallContext::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a780e56056d700663f495909afe2e3aa2" class="m-doc-self">CallContext</a>(</span><span class="m-doc-wrap"><a href="classminilua_1_1Environment.html" class="m-doc">Environment</a>* env)</span></span>
            </h3>
            <p>Create a <a href="classminilua_1_1CallContext.html" class="m-doc">CallContext</a> from the <a href="classminilua_1_1Environment.html" class="m-doc">Environment</a>.</p>
<aside class="m-note m-danger"><h4>Warning</h4><p>Only for internal use. Be careful that the <a href="classminilua_1_1Environment.html" class="m-doc">Environment</a> pointer outlives the <a href="classminilua_1_1CallContext.html" class="m-doc">CallContext</a>.</p></aside>
          </div></section>
          <section class="m-doc-details" id="aefa84bac078774d83b37c386428e9295"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />CallContext::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#aefa84bac078774d83b37c386428e9295" class="m-doc-self">make_new</a>(</span><span class="m-doc-wrap"><a href="classminilua_1_1Vallist.html" class="m-doc">Vallist</a>,
              std::optional&lt;<a href="structminilua_1_1Range.html" class="m-doc">Range</a>&gt; location = std::nullopt) const -&gt; CallContext</span></span>
            </h3>
            <p>Create a new call context with new arguments.</p>
<p>It reuses all other information.</p>
          </div></section>
          <section class="m-doc-details" id="a0467e04c54ba89888313abf53fd1cea5"><div>
            <h3>
              <div class="m-doc-template">
                template&lt;typename... Args&gt;
              </div>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />CallContext::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a0467e04c54ba89888313abf53fd1cea5" class="m-doc-self">make_new</a>(</span><span class="m-doc-wrap">Args... args,
              std::optional&lt;<a href="structminilua_1_1Range.html" class="m-doc">Range</a>&gt; location = std::nullopt) const -&gt; CallContext</span></span>
            </h3>
            <p>Create a new call context with new arguments.</p>
<p>It reuses all other information.</p>
          </div></section>
          <section class="m-doc-details" id="aee2e19ab5f3c347575a2c32d8613e21c"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />CallContext::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#aee2e19ab5f3c347575a2c32d8613e21c" class="m-doc-self">call_location</a>(</span><span class="m-doc-wrap">) const -&gt; std::optional&lt; Range &gt;</span></span>
            </h3>
            <p>The location of the call.</p>
<p>Can be <code>std::nullopt</code> if the <a href="classminilua_1_1CallContext.html" class="m-doc">CallContext</a> was not created by a lua function call.</p>
          </div></section>
          <section class="m-doc-details" id="aa294dae148654b06c23c24c6cce317c8"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />CallContext::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#aa294dae148654b06c23c24c6cce317c8" class="m-doc-self">environment</a>(</span><span class="m-doc-wrap">) const -&gt; Environment &amp;</span></span>
            </h3>
            <p>Returns a reference to the environment.</p>
<p>For <code><a href="classminilua_1_1Function.html" class="m-doc">Function</a></code>s created in C++ you can only access the global environment.</p><p>For functions created in lua you can access the global environment and local variables that were in scope when creating the function.</p>
          </div></section>
          <section class="m-doc-details" id="ab9537a0dc7692d70a9a0fd169feed1a1"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />CallContext::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#ab9537a0dc7692d70a9a0fd169feed1a1" class="m-doc-self">get</a>(</span><span class="m-doc-wrap">const std::string&amp; name) const -&gt; Value</span></span>
            </h3>
            <p>Returns the value of a variable accessible from the function.</p>
<p>Returns <code><a href="structminilua_1_1Nil.html" class="m-doc">Nil</a></code> if the variable is not accessible or does not exist.</p>
          </div></section>
          <section class="m-doc-details" id="a471e7bb088bc46470edc30ac008e73f1"><div>
            <h3>
              <div class="m-doc-template">
                template&lt;typename... Ts&gt;
              </div>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />CallContext::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a471e7bb088bc46470edc30ac008e73f1" class="m-doc-self">expect_argument</a>(</span><span class="m-doc-wrap">size_t index) const -&gt; const Value &amp;</span></span>
            </h3>
            <p>Helper to check required arguments.</p>
<p>Usage:</p><pre class="m-code"><span class="n">Value</span> <span class="n">table</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">expect_argument</span><span class="o">&lt;</span><span class="n">Table</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">Value</span> <span class="n">nil_or_table</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">expect_argument</span><span class="o">&lt;</span><span class="n">Nil</span><span class="p">,</span> <span class="n">Table</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Value</span> <span class="n">string_or_number</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">expect_argument</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Number</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span></pre><p>If the type does not match or the value is not present this method will throw a lua appropriate exception that looks something like this:</p><pre class="m-code"><span class="n">bad</span> <span class="n">argument</span> <span class="err">#</span><span class="mi">1</span> <span class="p">(</span><span class="n">table</span> <span class="n">expected</span><span class="p">,</span> <span class="n">got</span> <span class="n">no</span> <span class="n">value</span><span class="p">)</span></pre>
          </div></section>
          <section class="m-doc-details" id="a64de6fc9188934f54712f286ccb7c13d"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />CallContext::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a64de6fc9188934f54712f286ccb7c13d" class="m-doc-self">unary_numeric_arg_helper</a>(</span><span class="m-doc-wrap">) const -&gt; std::tuple&lt; Number, UnaryOrigin &gt;</span></span>
            </h3>
            <p>Convenience method for writing unary numeric functions.</p>
<p>Convenience method for writing functions with one numeric argument that should track the origin (e.g. pow).</p><p>Usage:</p><pre class="m-code"><span class="k">auto</span> <span class="p">[</span><span class="n">arg</span><span class="p">,</span> <span class="n">origin</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">unary_numeric_arg_helper</span><span class="p">();</span>
<span class="n">origin</span><span class="p">.</span><span class="n">reverse</span> <span class="o">=</span> <span class="n">unary_num_reverse</span><span class="p">(...);</span>
<span class="c1">// ...</span></pre><p>See also: <code><a href="classminilua_1_1CallContext.html#a21e7b7faef395d4762dda2f7ef8e6ac4" class="m-doc">CallContext::<wbr />binary_numeric_args_helper</a></code>.</p>
          </div></section>
          <section class="m-doc-details" id="a21e7b7faef395d4762dda2f7ef8e6ac4"><div>
            <h3>
              <span class="m-doc-wrap-bumper">auto minilua::<wbr />CallContext::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a21e7b7faef395d4762dda2f7ef8e6ac4" class="m-doc-self">binary_numeric_args_helper</a>(</span><span class="m-doc-wrap">) const -&gt; std::tuple&lt; Number, Number, BinaryOrigin &gt;</span></span>
            </h3>
            <p>Convenience method for writing unary numeric functions.</p>
<p>Convenience method for writing functions with two numeric arguments that should track the origin (e.g. sqrt).</p><p>Usage:</p><pre class="m-code"><span class="k">auto</span> <span class="p">[</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">origin</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">binary_numeric_arg_helper</span><span class="p">();</span>
<span class="n">origin</span><span class="p">.</span><span class="n">reverse</span> <span class="o">=</span> <span class="n">binary_num_reverse</span><span class="p">(...);</span>
<span class="c1">// ...</span></pre><p>See also: <code><a href="classminilua_1_1CallContext.html#a64de6fc9188934f54712f286ccb7c13d" class="m-doc">CallContext::<wbr />unary_numeric_arg_helper</a></code>.</p>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>MiniLua Value tracing lua interpreter. Created with <a href="https://doxygen.org/">Doxygen</a> 1.8.17 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
